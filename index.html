<!DOCTYPE html><html lang="ja"><head>
<meta charset="utf-8" />
<title>ç¦å²¡ è¡†é™¢å°é¸æŒ™åŒº ãƒãƒ©ã‚·é…å¸ƒçŠ¶æ³</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<style>
/* â€”â€” çœç•¥å¯ï¼šé…è‰²ã ã‘èª¿æ•´ â€”â€” */
:root{--bg:linear-gradient(135deg,#ff9a9e 0%,#fecfef 50%,#fecfef 100%);
--card:rgba(255,255,255,.95);--accent:#ff6b6b;--fg:#2c3e50;--border:rgba(255,107,107,.3)}
html,body{margin:0;height:100%;background:var(--bg);font-family:"Comic Sans MS","ãƒ¡ã‚¤ãƒªã‚ª",sans-serif;color:var(--fg);font-weight:600}
#map{height:100%;width:100%}.title{position:absolute;top:10px;left:50%;transform:translateX(-50%);
background:var(--card);padding:12px 24px;border-radius:24px;border:2px solid var(--border);
box-shadow:0 4px 15px rgba(255,107,107,.3);color:var(--accent);z-index:1000;font-size:1.15rem;
backdrop-filter:blur(10px);text-align:center}
.legend{background:var(--card);line-height:1.6em;padding:12px 18px;font-size:1rem;border-radius:18px;
border:2px solid var(--border);box-shadow:0 4px 18px rgba(255,107,107,.25);backdrop-filter:blur(10px)}
.legend i{width:18px;height:18px;float:left;margin-right:8px;border-radius:50%;border:2px solid rgba(255,107,107,.4)}
.leaflet-tooltip{background:var(--card)!important;border:2px solid var(--border)!important;border-radius:10px!important;
color:var(--fg)!important;font-weight:bold!important;box-shadow:0 3px 10px rgba(255,107,107,.3)!important}
</style></head><body>
<div class="title">ã€Œå®‰ä¾¡å®‰å¿ƒã§é£Ÿã¹ãŸã„ã‹ã‚‰æ”¿æ¨©ã‚‚ã„ãŸã ãã¾ã™ã€<br>ãƒãƒ©ã‚·é…å¸ƒçŠ¶æ³ï¼ˆç¦å²¡ 11 é¸æŒ™åŒºï¼‰</div>
<div id="map"></div>

<!-- Leaflet & shpjs -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/shpjs/6.1.0/shp.min.js"></script>

<script>
/* ===== 1. Leaflet åˆæœŸåŒ– ===== */
const map = L.map("map",{zoomSnap:.25,zoomControl:false})
  .setView([33.58,130.58],8.6);
L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",
  {attribution:"&copy;OpenStreetMap &amp; CARTO"}).addTo(map);
L.control.zoom({position:"bottomleft"}).addTo(map);

/* ===== 2. é…å¸ƒçŠ¶æ³ãƒ†ãƒ¼ãƒ–ãƒ« ===== */
const districtStatus = {
  "ç¦å²¡1åŒº":"completed",
  "ç¦å²¡2åŒº":"none",
  "ç¦å²¡3åŒº":"planned",
  "ç¦å²¡4åŒº":"none",
  "ç¦å²¡5åŒº":"none",
  "ç¦å²¡6åŒº":"none",
  "ç¦å²¡7åŒº":"none",
  "ç¦å²¡8åŒº":"none",
  "ç¦å²¡9åŒº":"none",
  "ç¦å²¡10åŒº":"none",
  "ç¦å²¡11åŒº":"none"
};

/* ===== 3. Shapefile â†’ GeoJSON èª­è¾¼ ===== */
const shpUrl = "https://gtfs-gis.jp/senkyoku/byku/senkyoku289polygon_byku_40.zip"; // ç¦å²¡çœŒã®ã¿
shp(shpUrl).then(fc=>{
  const layer = L.geoJSON(fc,{
    style:f=>styleByStatus(f),
    onEachFeature:(f,l)=>tooltipAndHover(f,l)
  }).addTo(map);
  map.fitBounds(layer.getBounds());
});

/* ===== 4. ã‚¹ã‚¿ã‚¤ãƒ«é–¢æ•° ===== */
function styleByStatus(feature){
  const name = feature.properties.KU || feature.properties.NAME || ""; // å±æ€§åã¯ç’°å¢ƒã«ã‚ˆã‚Šç•°ãªã‚‹
  const status = districtStatus[name]||"none";
  const colors = {completed:"#ff4757",planned:"#ffa502",none:"#a4b0be"};
  return {weight:2,color:"#ff6b6b",fillOpacity:.75,fillColor:colors[status]};
}

/* ===== 5. Tooltip & Hover ===== */
function tooltipAndHover(feature,layer){
  const name = feature.properties.KU || feature.properties.NAME || "";
  const st = districtStatus[name]||"none";
  const label = {completed:"âœ… é…å¸ƒæ¸ˆã¿",planned:"ğŸ“‹ é…å¸ƒäºˆå®š",none:"âŒ æœªé…å¸ƒ"}[st];
  layer.bindTooltip(`${name}<br><strong>${label}</strong>`,{sticky:true});
  layer.on({
    mouseover:e=>e.target.setStyle({weight:4,color:"#ff4757",fillOpacity:.9}),
    mouseout:e=>e.target.setStyle({weight:2,color:"#ff6b6b",fillOpacity:.75})
  });
}

/* ===== 6. å‡¡ä¾‹ ===== */
L.control({position:"bottomright"}).onAdd=_=>{
  const d=document.createElement("div");d.className="legend";
  d.innerHTML=`
    <strong>ğŸ—³ï¸ é…å¸ƒçŠ¶æ³</strong><br>
    <i style="background:#ff4757"></i> âœ… é…å¸ƒæ¸ˆã¿<br>
    <i style="background:#ffa502"></i> ğŸ“‹ é…å¸ƒäºˆå®š<br>
    <i style="background:#a4b0be"></i> âŒ æœªé…å¸ƒ<br>`;
  return d;
}.addTo(map);
</script>
</body></html>
